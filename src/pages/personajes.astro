---
import Layout from '../layouts/Layout.astro';
import SectionTitle from '../components/SectionTitle.astro';
import FilterBar from '../components/FilterBar.astro';
import PersonajeCard from '../components/PersonajeCard.astro';
---

<Layout title="Personajes - Batman">
    <div class="personajes-container">
        <SectionTitle title="Personajes del Universo de Batman" />
        
        <!-- Filtros -->
        <div class="controles">
            <FilterBar filtros={["Todos", "Aliados", "Enemigos"]} selected="Todos" />
        </div>

        <!-- <div id="contador-resultados" class="contador"></div> -->
        
        <!-- Sección de Aliados -->
        <section class="seccion aliados" data-categoria="aliados">
            <h2 class="titulo-seccion">Aliados</h2>
            <div class="grid-personajes">
                <PersonajeCard nombre="Robin" descripcion="Dick Grayson, el primer Robin y compañero fiel de Batman. Acróbata excepcional y líder de los Jóvenes Titanes." categoria="aliados" />
                <PersonajeCard nombre="Alfred Pennyworth" descripcion="Mayordomo y figura paterna de Bruce Wayne. Su sabiduría y apoyo son fundamentales para Batman." categoria="aliados" />
                <PersonajeCard nombre="Comisionado Gordon" descripcion="Jefe de la policía de Gotham y aliado clave de Batman en la lucha contra el crimen." categoria="aliados" />
                <PersonajeCard nombre="Batgirl" descripcion="Barbara Gordon, hija del Comisionado. Experta en tecnología y combate." categoria="aliados" />
                <PersonajeCard nombre="Nightwing" descripcion="La identidad adulta de Dick Grayson. Héroe independiente pero siempre leal a la familia Bat." categoria="aliados" />
                <PersonajeCard nombre="Lucius Fox" descripcion="Genio tecnológico y CEO de Wayne Enterprises. Creador del equipamiento de Batman." categoria="aliados" />
                <PersonajeCard nombre="Oráculo" descripcion="Barbara Gordon como experta hacker y apoyo táctico para Batman y la Batfamilia." categoria="aliados" />
                <PersonajeCard nombre="Azrael" descripcion="Jean-Paul Valley, guerrero entrenado por la Orden de San Dumas, llegó a portar el manto de Batman." categoria="aliados" />
                <PersonajeCard nombre="Huntress" descripcion="Helena Bertinelli, justiciera de Gotham con métodos implacables y gran habilidad con la ballesta." categoria="aliados" />
                <PersonajeCard nombre="Batwoman" descripcion="Kate Kane, prima de Bruce Wayne, luchadora experta y defensora de Gotham." categoria="aliados" />
                <PersonajeCard nombre="Red Hood" descripcion="Jason Todd, ex-Robin resucitado, ahora vigilante letal con su propio código." categoria="aliados" />
                <PersonajeCard nombre="Spoiler" descripcion="Stephanie Brown, joven heroína que ha sido Spoiler, Robin y Batgirl." categoria="aliados" />
                <PersonajeCard nombre="Ace el Bati-sabueso" descripcion="El fiel perro de Batman, entrenado para misiones especiales." categoria="aliados" />
                <PersonajeCard nombre="Cassandra Cain" descripcion="Hija de asesinos, experta en artes marciales, ha sido Batgirl y Orphan." categoria="aliados" />
                <PersonajeCard nombre="Tim Drake" descripcion="El tercer Robin, gran detective y líder de los Jóvenes Titanes como Red Robin." categoria="aliados" />
                <PersonajeCard nombre="Duke Thomas" descripcion="The Signal, aliado con habilidades metahumanas y protector diurno de Gotham." categoria="aliados" />
                <PersonajeCard nombre="Lucius Fox Jr." descripcion="Hijo de Lucius Fox, ingeniero brillante y aliado tecnológico de la Batfamilia." categoria="aliados" />
            </div>
        </section>

        <!-- Sección de Enemigos -->
        <section class="seccion enemigos" data-categoria="enemigos">
            <h2 class="titulo-seccion">Enemigos</h2>
            <div class="grid-personajes">
                <PersonajeCard nombre="El Joker" descripcion="El némesis por excelencia. Criminal demente obsesionado con el caos y Batman." categoria="enemigos" />
                <PersonajeCard nombre="El Pingüino" descripcion="Oswald Cobblepot, señor del crimen con apariencia de pingüino y paraguas mortales." categoria="enemigos" />
                <PersonajeCard nombre="El Acertijo" descripcion="Edward Nygma, criminal obsesionado con los acertijos y demostrar su superioridad intelectual." categoria="enemigos" />
                <PersonajeCard nombre="Catwoman" descripcion="Selina Kyle, ladrona de joyas con una relación compleja con Batman." categoria="enemigos" />
                <PersonajeCard nombre="Dos Caras" descripcion="Harvey Dent, ex fiscal convertido en criminal que toma decisiones lanzando una moneda." categoria="enemigos" />
                <PersonajeCard nombre="Bane" descripcion="Táctico brutal conocido por romper la espalda de Batman. Fuerza sobrehumana." categoria="enemigos" />
                <PersonajeCard nombre="Scarecrow" descripcion="Jonathan Crane, maestro del miedo que utiliza toxinas para aterrorizar a sus víctimas." categoria="enemigos" />
                <PersonajeCard nombre="Hiedra Venenosa" descripcion="Pamela Isley, eco-terrorista con control sobre las plantas y toxinas letales." categoria="enemigos" />
                <PersonajeCard nombre="Mr. Freeze" descripcion="Victor Fries, científico trágico que usa tecnología criogénica para salvar a su esposa." categoria="enemigos" />
                <PersonajeCard nombre="Ra’s al Ghul" descripcion="Líder de la Liga de las Sombras, busca la inmortalidad y la destrucción de Gotham." categoria="enemigos" />
                <PersonajeCard nombre="Talia al Ghul" descripcion="Hija de Ra’s al Ghul, experta luchadora y amor imposible de Batman." categoria="enemigos" />
                <PersonajeCard nombre="Clayface" descripcion="Basil Karlo, actor convertido en monstruo de arcilla capaz de cambiar de forma." categoria="enemigos" />
                <PersonajeCard nombre="Killer Croc" descripcion="Waylon Jones, criminal con apariencia reptiliana y fuerza sobrehumana." categoria="enemigos" />
                <PersonajeCard nombre="Harley Quinn" descripcion="Harleen Quinzel, ex-psiquiatra y socia caótica del Joker." categoria="enemigos" />
                <PersonajeCard nombre="Hush" descripcion="Thomas Elliot, cirujano brillante y enemigo obsesionado con destruir a Bruce Wayne." categoria="enemigos" />
                <PersonajeCard nombre="Firefly" descripcion="Garfield Lynns, pirómano profesional armado con lanzallamas y traje volador." categoria="enemigos" />
                <PersonajeCard nombre="Black Mask" descripcion="Roman Sionis, jefe criminal conocido por su máscara de ébano y brutalidad." categoria="enemigos" />
                <PersonajeCard nombre="Solomon Grundy" descripcion="Zombi gigante con fuerza descomunal, resucita cada vez que es derrotado." categoria="enemigos" />
                <PersonajeCard nombre="Man-Bat" descripcion="Kirk Langstrom, científico que se transforma en un monstruo mitad hombre, mitad murciélago." categoria="enemigos" />
                <PersonajeCard nombre="Calendar Man" descripcion="Julian Day, criminal obsesionado con fechas y eventos especiales." categoria="enemigos" />
                <PersonajeCard nombre="Ventrílocuo y Scarface" descripcion="Arnold Wesker y su marioneta mafiosa, Scarface, temidos en el bajo mundo." categoria="enemigos" />
                <PersonajeCard nombre="Mad Hatter" descripcion="Jervis Tetch, criminal obsesionado con Alicia en el País de las Maravillas y el control mental." categoria="enemigos" />
                <PersonajeCard nombre="Deadshot" descripcion="Floyd Lawton, el mejor tirador del mundo, mercenario letal y miembro del Escuadrón Suicida." categoria="enemigos" />
                <PersonajeCard nombre="Deathstroke" descripcion="Slade Wilson, mercenario y asesino de élite, rival físico e intelectual de Batman." categoria="enemigos" />
                <PersonajeCard nombre="Zsasz" descripcion="Victor Zsasz, asesino en serie que marca su piel por cada víctima." categoria="enemigos" />
            </div>
        </section>
    </div>
</Layout>

<style>
    .personajes-container {
        padding: 20px;
    }

    h1 {
        text-align: center;
        color: #f7d354;
        font-size: 2.5rem;
        margin-bottom: 40px;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    /* Controles de búsqueda y filtrado */
    .controles {
        max-width: 800px;
        margin: 0 auto 40px;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .buscador {
        width: 100%;
        padding: 15px 20px;
        font-size: 1.1rem;
        border: 3px solid #f7d354;
        border-radius: 10px;
        background-color: rgba(0, 0, 0, 0.6);
        color: white;
        outline: none;
        transition: all 0.3s ease;
    }

    .buscador:focus {
        background-color: rgba(0, 0, 0, 0.8);
        box-shadow: 0 0 20px rgba(247, 211, 84, 0.5);
    }

    .buscador::placeholder {
        color: #999;
    }

    .filtros {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
    }

    .btn-filtro {
        padding: 12px 30px;
        font-size: 1rem;
        font-weight: bold;
        border: 2px solid #f7d354;
        border-radius: 8px;
        background-color: rgba(0, 0, 0, 0.6);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .btn-filtro:hover {
        background-color: rgba(247, 211, 84, 0.2);
        transform: translateY(-2px);
    }

    .btn-filtro.active {
        background-color: #f7d354;
        color: #000;
        box-shadow: 0 4px 15px rgba(247, 211, 84, 0.5);
    }

    .contador {
        text-align: center;
        color: #f7d354;
        font-size: 1.1rem;
        margin-bottom: 20px;
        min-height: 30px;
    }

    .seccion {
        margin-bottom: 60px;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        transition: all 0.3s ease;
    }

    .seccion.oculto {
        display: none;
    }

    .aliados {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        border: 3px solid #4a90e2;
    }

    .enemigos {
        background: linear-gradient(135deg, #4a0e0e 0%, #8b1a1a 100%);
        border: 3px solid #e74c3c;
    }

    .titulo-seccion {
        text-align: center;
        font-size: 2rem;
        margin-bottom: 30px;
        color: #f7d354;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .grid-personajes {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
    }

    .card-personaje {
        background-color: rgba(0, 0, 0, 0.4);
        padding: 25px;
        border-radius: 10px;
        transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.3s ease;
        border: 2px solid rgba(247, 211, 84, 0.3);
    }

    .card-personaje.oculto {
        display: none;
    }

    .card-personaje:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(247, 211, 84, 0.3);
        border-color: #f7d354;
    }

    .card-personaje h3 {
        color: #f7d354;
        font-size: 1.5rem;
        margin-bottom: 15px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .card-personaje p {
        color: #e0e0e0;
        line-height: 1.6;
        font-size: 0.95rem;
    }

    @media (max-width: 768px) {
        .grid-personajes {
            grid-template-columns: 1fr;
        }

        h1 {
            font-size: 2rem;
        }

        .titulo-seccion {
            font-size: 1.5rem;
        }

        .filtros {
            flex-direction: column;
        }

        .btn-filtro {
            width: 100%;
        }
    }
</style>

<script>
    // Funcionalidad de filtrado y búsqueda
    // const buscador = document.getElementById('buscador') as HTMLInputElement;
    const botonesFiltro = document.querySelectorAll('.btn-filtro');
    const tarjetasPersonajes = document.querySelectorAll('.card-personaje');
    const secciones = document.querySelectorAll('.seccion');
    const contadorResultados = document.getElementById('contador-resultados');

    let filtroActual = 'todos';

    // Función para actualizar la visualización solo por filtro
    function actualizarVista() {
        // Filtrar personajes solo por categoria
        tarjetasPersonajes.forEach(tarjeta => {
            const categoria = (tarjeta as HTMLElement).dataset.categoria;
            const coincideCategoria = filtroActual === 'todos' || categoria === filtroActual;
            if (coincideCategoria) {
                tarjeta.classList.remove('oculto');
            } else {
                tarjeta.classList.add('oculto');
            }
        });

        // Mostrar/ocultar secciones solo si tienen personajes visibles
        secciones.forEach(seccion => {
            const categoria = (seccion as HTMLElement).dataset.categoria;
            // Seleccionar solo las tarjetas de esta sección
            const visibles = Array.from(seccion.querySelectorAll('.card-personaje')).filter(card => !card.classList.contains('oculto'));
            if (visibles.length > 0 && (filtroActual === 'todos' || categoria === filtroActual)) {
                seccion.classList.remove('oculto');
            } else {
                seccion.classList.add('oculto');
            }
        });
    }

    // (Eliminado event listener del buscador)

    // Event listeners para los botones de filtro
    botonesFiltro.forEach(boton => {
        boton.addEventListener('click', () => {
            // Remover clase active de todos los botones
            botonesFiltro.forEach(b => b.classList.remove('active'));
            // Añadir clase active al botón clickeado
            boton.classList.add('active');
            
            // Actualizar filtro actual
            filtroActual = (boton as HTMLElement).dataset.filtro || 'todos';
            
            // Actualizar vista
            actualizarVista();
        });
    });
</script>
